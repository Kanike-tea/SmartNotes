7.2 Input Enhancement in String Matching 261

always made by the brute-force algorithm. However, if such an algorithm had
to check all the characters of the pattern on every trial, it would lose much
of this superiority. Fortunately, the idea of input enhancement makes repetitive
comparisons unnecessary. We can precompute shift sizes and store them in a table.
The table will be indexed by all possible characters that can be encountered in a
text, including, for natural language texts, the space, punctuation symbols, and
other special characters. (Note that no other information about the text in which
eventual searching will be done is required.) The table’s entries will indicate the
shift sizes computed by the formula

the pattern’s length m,
if c is not among the first m — 1 characters of the pattern;

t(c)= (7.1)
the distance from the rightmost c among the first m — 1 characters
of the pattern to its last character, otherwise.

For example, for the pattern BARBER, all the table’s entries will be equal to 6, except
for the entries for E, B, R, and A, which will be 1, 2, 3, and 4, respectively.

Here is a simple algorithm for computing the shift table entries. Initialize all
the entries to the pattern’s length m and scan the pattern left to right repeating the
following step m — 1 times: for the jth character of the pattern (0 < j <m —2),
overwrite its entry in the table with m — 1 — j, which is the character’s distance to
the last character of the pattern. Note that since the algorithm scans the pattern
from left to right, the last overwrite will happen for the character’s rightmost
occurrence—exactly as we would like it to be.

ALGORITHM - ShiftTable(P[0..m — 1])
//Fills the shift table used by Horspool’s and Boyer-Moore algorithms
/[Input: Pattern P[0..m — 1] and an alphabet of possible characters
//Output: Table[0..size — 1] indexed by the alphabet’s characters and
i filled with shift sizes computed by formula (7.1)
for i <0 to size — 1 do Table[i] <—m
for j <0 to m —2 do Table[P[j]]<—m—-1-j
return Table

Now, we can summarize the algorithm as follows:

Horspool'’s algorithm

Step 1 For a given pattern of length m and the alphabet used in both the
pattern and text, construct the shift table as described above.

Step 2 Align the pattern against the beginning of the text.

Step 3 Repeat the following until either a matching substring is found or the
pattern reaches beyond the last character of the text. Starting with the
last character in the pattern, compare the corresponding characters in
the pattern and text until either all m characters are matched (then