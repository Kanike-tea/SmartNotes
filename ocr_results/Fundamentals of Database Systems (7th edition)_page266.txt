236

Chapter 7 More SQL: Complex Queries, Triggers, Views, and Schema Modification

are shown in angled brackets < ... >, optional parts are shown in square brac-

kets [

parentheses (... |

... ], repetitions are shown in braces { ... }, and alternatives are shown in

de

Review Questions

7.1. Describe the six clauses in the syntax of an SQL retrieval query. Show what
type of constructs can be specified in each of the six clauses. Which of the six
clauses are required and which are optional?

7.2. Describe conceptually how an SQL retrieval query will be executed by speci-
fying the conceptual order of executing each of the six clauses.

7.3. Discuss how NULLs are treated in comparison operators in SQL. How are
NULLs treated when aggregate functions are applied in an SQL query? How
are NULLs treated if they exist in grouping attributes?

7.4. Discuss how each of the following constructs is used in SQL, and discuss
the various options for each construct. Specify what each construct is
useful for.

a. Nested queries
b. Joined tables and outer joins
c. Aggregate functions and grouping
d. Triggers
e. Assertions and how they differ from triggers
f. The SQL WITH clause
g. SQL CASE construct
h. Views and their updatability
i, Schema change commands

Exercises

7.5. Specify the following queries on the database in Figure 5.5 in SQL. Show the

query results if each query is applied to the database state in Figure 5.6.

a. For each department whose average employee salary is more than
$30,000, retrieve the department name and the number of employees
working for that department.

b. Suppose that we want the number of male employees in each department
making more than $30,000, rather than all employees (as in Exer-
cise 7.5a). Can we specify this query in SQL? Why or why not?

7The full syntax of SQL is described in many voluminous documents of hundreds of pages.