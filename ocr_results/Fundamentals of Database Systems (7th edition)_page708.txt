678

Chapter 18 Strategies for Query Processing

can be converted into the following:

SELECT DISTINCT DEPARTMENT.Dnumber
FROM DEPARTMENT, EMPLOYEE
WHERE DEPARTMENT.Dnumber A = EMPLOYEE.Dno

We used the nonstandard notation for anti-join, “A=”, where DEPARTMENT is on
the left of anti-join and EMPLOYEE is on the right.

In SQL, there are two variations of these set operations. The operations
UNION, INTERSECTION, and EXCEPT or MINUS (the SQL keywords for the SET
DIFFERENCE operation) apply to traditional sets, where no duplicate records
exist in the result. The operations UNION ALL, INTERSECTION ALL, and EXCEPT
ALL apply to multisets (or bags). Thus, going back to the database of Figure 5.5,
consider a query that finds all departments that employees are working on
where at least one project exists controlled by that department, and this result
is written as:

SELECT Dno from EMPLOYEE
INTERSECT ALL
SELECT Dum from PROJECT

This would not eliminate any duplicates of Dno from EMPLOYEE while perform-
ing the INTERSECTION. If all 10,000 employees are assigned to departments
where some project is present in the PROJECT relation, the result would be the list
of all the 10,000 department numbers including duplicates.. This can be accom-
plished by the semi-join operation we introduced in Section 18.1 as follows:

SELECT DISTINCT EMPLOYEE.Dno
FROM DEPARTMENT, EMPLOYEE
WHERE EMPLOYEE.Dno S = DEPARTMENT.Dnumber

If INTERSECTION is used without the ALL, then an additional step of duplicate
elimination will be required for the selected department numbers.

18.6 Implementing Aggregate Operations
and Different Types of JOINS

18.6.1 Implementing Aggregate Operations

The aggregate operators (MIN, MAX, COUNT, AVERAGE, SUM), when applied to an
entire table, can be computed by a table scan or by using an appropriate index, if
available. For example, consider the following SQL query:

SELECT MAX(Salary)
FROM — EMPLOYEE;

If an (ascending) B*-tree index on Salary exists for the EMPLOYEE relation, then
the optimizer can decide on using the Salary index to search for the largest Salary
value in the index by following the rightmost pointer in each index node from the