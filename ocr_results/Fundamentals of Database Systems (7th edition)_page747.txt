19.5 Cost Functions for the JOIN Operation

(average cost for a selection on a key attribute). For OP1 we can use either method
S1 or method S6a; the cost estimate for S6a is Cs¢q = Xssn + 1 = 4 + 1 =5, and it is
chosen over method S1, whose average cost is Cs}, = 1,000. For OP2 we can use
either method S1 (with estimated cost Cs}q = 2,000) or method S6b (with estimated
cost Ceh = XDno + (Dr pno/2) + (rg /2) = 2 + (4/2) + (10,000/2) = 5,004), so we choose
the linear search approach for OP2. For OP3 we can use either method $1 (with
estimated cost Cs)_ = 2,000) or method S6a (with estimated cost Cg6q = XDno + SDno =
2 + 80 = 82), so we choose method S6a.

Finally, consider OP4, which has a conjunctive selection condition. We need to esti-
mate the cost of using any one of the three components of the selection condition to
retrieve the records, plus the linear search approach. The latter gives cost estimate
Csiq = 2000. Using the condition (Dno = 5) first gives the cost estimate Cgg, = 82.
Using the condition (Salary > 30000) first gives a cost estimate Cg4 = XSatary + (bp/2) =
3 + (2000/2) = 1003. Using the condition (Sex = ‘F’) first gives a cost estimate Cgg, =
Xgex + Sgex = 1 + 5000 = 5001. The optimizer would then choose method S6a on the
secondary index on Dno because it has the lowest cost estimate. The condition
(Dno = 5) is used to retrieve the records, and the remaining part of the conjunctive
condition (Salary > 30,000 AND Sex = ‘F’) is checked for each selected record after it
is retrieved into memory. Only the records that satisfy these additional conditions
are included in the result of the operation. Consider the Dno = 5 condition in OP3
above; Dno has 125 values and hence a B*-tree index would be appropriate. Instead,
if we had an attribute Zipcode in EMPLOYEE and if the condition were Zipcode =
30332 and we had only five zip codes, bitmap indexing could be used to know what
records qualify. Assuming uniform distribution, szipcode = 2,000. This would result
ina cost of 2,000 for bitmap indexing.

19.5 Cost Functions for the JOIN Operation

To develop reasonably accurate cost functions for JOIN operations, we must have an
estimate for the size (number of tuples) of the file that results after the JOIN opera-
tion. This is usually kept as a ratio of the size (number of tuples) of the resulting join
file to the size of the CARTESIAN PRODUCT file, if both are applied to the same input
files, and it is called the join selectivity (js). If we denote the number of tuples of a
relation R by |R|, we have:

js =\(R™, S)|/|(R x S)| = |(R™- S)| / (RI * |S)

If there is no join condition c, then js = 1 and the join is the same as the CARTESIAN
PRODUCT. If no tuples from the relations satisfy the join condition, then js = 0. In
general, 0 < js < 1. For a join where the condition c is an equality comparison
R.A=S.B, we get the following two special cases:

1. If A is a key of R, then |(R™, S)| < |S|, so js < (1/|R]). This is because each
record in file S will be joined with at most one record in file R, since A is a
key of R. A special case of this condition is when attribute B is a foreign key
of S that references the primary key A of R. In addition, if the foreign key B

717