714

Chapter 19 Query Optimization

19.4 Cost Functions for SELECT Operation

We now provide cost functions for the selection algorithms $1 to $8 discussed in
Section 18.3.1 in terms of number of block transfers between memory and disk.
Algorithm $9 involves an intersection of record pointers after they have been
retrieved by some other means, such as algorithm $6, and so the cost function will
be based on the cost for S6. These cost functions are estimates that ignore computa-
tion time, storage cost, and other factors. To reiterate, the following notation is
used in the formulas hereafter:

Cs;: Cost for method Si in block accesses

ry: Number of records (tuples) in a relation X

by: Number of blocks occupied by relation X (also referred to as b)
bfrx: Blocking factor (i.e., number of records per block) in relation X
sl,: Selectivity of an attribute A for a given condition

SA: Selection cardinality of the attribute being selected (= s/, +r)

xA: Number of levels of the index for attribute A

by A: Number of first-level blocks of the index on attribute A

NDV (A, X): Number of distinct values of attribute A in relation X

Note: In using the above notation in formulas, we have omitted the relation name
or attribute name when it is obvious.

= S1—Linear search (brute force) approach. We search all the file blocks to
retrieve all records satisfying the selection condition; hence, Cs)q = b. For an
equality condition on a key attribute, only half the file blocks are searched on
the average before finding the record, so a rough estimate for Cs1y = (b/2) if
the record is found; if no record is found that satisfies the condition, Cs), = b.

= $2—Binary search. This search accesses approximately Cs, =
logab +I (s/bfr) |= 1 file blocks. This reduces to log.) if the equality condition
is on a unique (key) attribute, because s = 1 in this case.

= S$3a—Using a primary index to retrieve a single record. For a primary
index, retrieve one disk block at each index level, plus one disk block from
the data file. Hence, the cost is one more disk block than the number of
index levels: Cy3, =x + 1.

= S3b—Using a hash key to retrieve a single record. For hashing, only one
disk block needs to be accessed in most cases. The cost function is approxi-
mately Cs3, = 1 for static hashing or linear hashing, and it is 2 disk block
accesses for extendible hashing (see Section 16.8).

= S4—Using an ordering index to retrieve multiple records. If the compari-
son condition is >, >=, <, or <=on a key field with an ordering index, roughly
half the file records will satisfy the condition. This gives a cost function of
Cs4= x + (b/2). This is a very rough estimate, and although it may be correct
on the average, it may be inaccurate in individual cases. A more accurate
estimate is possible if the distribution of records is stored in a histogram.

= $5—Using a clustering index to retrieve multiple records. One disk block
is accessed at each index level, which gives the address of the first file disk