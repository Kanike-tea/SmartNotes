8.2 Relational Algebra Operations from Set Theory

employees who either work in department 5 or directly supervise an employee who
works in department 5, we can use the UNION operation as follows:*

DEP5_EMPS < Opno-5(EMPLOYEE)
RESULT1 < Tigoq(DEP5_EMPS)
RESULT2(Ssn) < Tguper_ssn(DEP5_EMPS)
RESULT < RESULT1 U RESULT2

The relation RESULT1 has the Ssn of all employees who work in department 5,
whereas RESULT? has the Ssn of all employees who directly supervise an employee
who works in department 5. The UNION operation produces the tuples that are in
either RESULT1 or RESULT2 or both (see Figure 8.3) while eliminating any dupli-
cates. Thus, the Ssn value ‘333445555’ appears only once in the result.

Several set theoretic operations are used to merge the elements of two sets in vari-
ous ways, including UNION, INTERSECTION, and SET DIFFERENCE (also called
MINUS or EXCEPT). These are binary operations; that is, each is applied to two sets
(of tuples). When these operations are adapted to relational databases, the two rela-
tions on which any of these three operations are applied must have the same type of
tuples; this condition has been called union compatibility or type compatibility.
Two relations R(Aj, Aj, ... , A,) and S(B,, By, ... , B,) are said to be union
compatible (or type compatible) if they have the same degree n and if dom(A;) =
dom(B;) for 1 < i < n. This means that the two relations have the same number of
attributes and each corresponding pair of attributes has the same domain.

We can define the three operations UNION, INTERSECTION, and SET DIFFERENCE
on two union-compatible relations R and S as follows:

= UNION: The result of this operation, denoted by R U S, is a relation that
includes all tuples that are either in R or in S or in both R and S. Duplicate
tuples are eliminated.

= INTERSECTION: The result of this operation, denoted by RO S, is a relation
that includes all tuples that are in both R and S.

= SET DIFFERENCE (or MINUS): The result of this operation, denoted by R - S,
is a relation that includes all tuples that are in R but not in S.

247

RESULT1 RESULT2 RESULT Figure 8.3
Ssn Ssn Ssn
123456789 333445555 123456789
333445555 888665555 333445555
666884444 666884444
453453453 453453453
888665555

4As a single relational algebra expression, this becomes Result @ seq (Gpno~s (EMPLOYEE) ) U
TMSuper_ssn (GDno=5 (EMPLOYEE).

Result of the UNION operation
RESULT < RESULT1 U RESULT2.